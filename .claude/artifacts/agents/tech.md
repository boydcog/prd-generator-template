# Maththera 기술 평가 보고서

**역할**: Tech (기술 타당성, 아키텍처, 비기능 요구사항)
**버전**: 1.0
**작성일**: 2026-02-13

---

## 기술 타당성 평가

### 적응형 알고리즘의 구현 가능성

Maththera의 핵심 엔진인 Adaptive Logic은 사전 태깅된 CSV 기반 문제 뱅크(15,053문제)에서 W_총점(Working Memory 부하)과 C 레벨(교과과정 단계)이라는 두 축의 수치를 실시간으로 쿼리하여 다음 문제를 결정한다. 아이가 문제를 틀렸을 때, 시스템은 해당 문제의 W_총점과 C 레벨을 확인한 후 진단 질문을 통해 경로를 분기한다.
[출처: SRC-adaptive-logic@92f6e625#chunk-0000]

이 구조는 기술적으로 매우 유리하다. 복잡한 ML 모델이나 신경망 없이, **규칙 기반(rule-based) 결정 트리**로 전체 적응형 로직을 구현할 수 있다. 문제 뱅크의 각 문제에 W1~W6 가중치와 C 레벨이 사전 태깅되어 있으므로, 런타임에서의 계산은 단순한 필터링과 정렬에 불과하다.

### W/C 이중 태그 체계의 데이터 구조

W_총점은 6개 하위 가중치의 합산으로 계산된다:

| 가중치 | 의미 | 범위 |
|--------|------|------|
| W1_연산 | 연산 유형 | 0/1.5 |
| W2_자릿수 | 자릿수 | 0~4 |
| W3_숫자크기 | 크기 | 0~1 |
| W4_복잡성 | 절차 | 0/3 |
| W5_특수수 | 보정 | -1.5~0 |
| W6_표현 | 형식 | 0.5 |

W_총점 범위는 0~약 9.5이며, 0.5 단위로 23개 레벨로 구간화된다. 교과과정(C)은 15개 단원으로 구성되며, C1(한 자릿수 덧셈)부터 C15(두 자릿수 받아내림 뺄셈)까지 난이도 순서가 명확하다. C 레벨 간 이동은 정수 연산(C-1, C-2, C+1)으로 처리되므로 추가적인 난이도 보정 알고리즘이 불필요하다.
[출처: SRC-wc-problem-bank@chunk-0000]

15,053문제 전체가 CSV 형태로 W1~W6 개별 점수, W_총점, W 레벨, C 레벨을 포함하고 있어, 이를 RDBMS에 적재하거나 인메모리 배열로 로드하여 복합 인덱스 조회가 가능하다. 데이터 크기는 수 MB 수준이므로 앱 번들에 포함하거나 서버 메모리에 전체 캐시하는 것이 모두 실현 가능하다.
[출처: SRC-path-tag-w-order@d17fde4f#chunk-0000]

### 반응 속도 기반 분기

핵심 원칙 중 "반응 속도가 기준(정답이어도 느리면 자동화 미완성)"이라는 요구사항이 있다. 이는 문제 제시 시점부터 응답 완료까지의 시간을 밀리초 단위로 측정하는 타이머 시스템이 필수적임을 의미한다. 정답이더라도 5초 이상 소요되면 동일 W/C 수준의 다른 문제를 반복 제시하여 Fluency(자동화)를 훈련해야 한다.
[출처: SRC-adaptive-algorithm@chunk-0000]

---

## 아키텍처 개요

### 핵심 분기 로직: 2-Path Decision Tree

적응형 알고리즘의 핵심은 오답 발생 시 2개 경로 중 하나를 선택하는 이진 분기 구조이다:

**경로 A (W 하향 - 작업기억 최적화)**: 아이가 전략은 알지만 계산에서 막힐 때 적용한다. 동일한 C 레벨 내에서 W_총점이 낮은 문제를 검색하여 뇌가 처리해야 할 정보량을 줄인다. 예를 들어 8+6(W:4.5)에서 실패하면 9+2(W:2.5)를 제시한다.

**경로 B (C 하향 - 개념적 후퇴)**: 가르는 이유나 보수 자체를 모를 때 적용한다. C 레벨을 1~2단계 아래로 낮추어 검색한다. 예를 들어 8+6(C:7)에서 양적 관계가 깨졌으면 8+□=10(C:5)으로 후퇴한다.
[출처: SRC-adaptive-logic@92f6e625#chunk-0001]

이 분기 판단의 입력은 "진단 질문"에 대한 아이의 응답이다. 기술적으로 이는 결정 트리(Decision Tree)의 루트 노드에서 단일 조건 분기로 구현되며, 복잡한 분류 모델이 필요하지 않다.

### 상태 머신 기반 훈련 루프

훈련 루프는 4가지 반응 상태에 따라 W/C 파라미터를 조정하는 상태 머신(State Machine)으로 모델링된다:

| 아이의 반응 | 전이 조건 | 훈련 목적 |
|------------|-----------|-----------|
| 심각한 오답 (8+6=1) | C -2 & W < 1.0 | 수 관계 기초 복구 |
| 논리적 오답 (가르기 실수) | C 유지 & W -1.5 | 작업기억 부하 경감 |
| 정답이지만 느림 (5초+) | C, W 동일 | 자동화(Fluency) |
| 정답 및 빠른 반응 | W +1.0 또는 C +1 | 도전적 과제 |

[출처: SRC-adaptive-logic@92f6e625#chunk-0002]

각 상태 전이의 조건이 수치적으로 명확히 정의되어 있으므로, 유한 상태 머신(FSM)으로 직접 구현할 수 있다.

### 3단계 복귀 루프 (Scaffolded Recovery)

Downscaling 후 원래 문제로 복귀하는 과정은 3단계로 설계되어 있다:

1. **기준점 고정**: 단순화된 문제(예: 100+90)를 풀어 큰 수의 결합을 인지시킨다
2. **미세 조정(가르기)**: "원래 문제는 100이 아니라 98이었지? 190에서 2를 빼면?" 식으로 가역성을 연습시킨다
3. **복귀**: 원래 문제(98+90)를 다시 제시하여 아이가 스스로 '어디서 가를지' 결정하는지 확인한다

[출처: SRC-adaptive-logic@92f6e625#chunk-0005]

이 3단계 루프는 **세션 컨텍스트**에 현재 단계(step), 원래 문제(original_problem), 단순화된 문제(scaffold_problem), 각 단계 결과(step_results)를 저장하는 구조가 필요하다. 세션이 중단되었다가 재개될 때에도 정확한 단계에서 이어갈 수 있어야 한다.

### Downscaling/Upscaling 전략과 UI 모드

Downscaling은 4가지 전략으로 구현된다: (1) 시각적 보조(10 프레임/계란판) 투입, (2) 단계 분리("계산하지 말고 결정만 해봐"), (3) 숫자 크기 축소, (4) 세로셈 전환. Upscaling은 3가지: (1) 시각 힌트 제거, (2) 추상화(가르기 선 없이), (3) 수치 확장.
[출처: SRC-adaptive-algorithm@chunk-0000]

이 전략들은 기술적으로 두 가지 메커니즘으로 구현된다:
- **UI 렌더링 모드**: 시각 보조 on/off, 세로셈/가로셈 전환, 힌트 표시/숨김 등의 렌더링 파라미터
- **문제 선택 파라미터**: W_총점 필터 범위, C 레벨 오프셋, 숫자 크기 제한 등의 쿼리 조건

### 가역성/결합-분해 진단의 기술적 난제

100+90=190을 풀 수 있는데 98+90에서 막히는 경우, 이는 가역성(Invertibility)과 결합/분해(Composition)의 연결 부위가 느슨한 상태이다. 이를 감지하려면 단순 정오답 판정을 넘어, 아이의 풀이 전략("어디서 가를지", "빌려오기 전략 사용 여부")을 추적해야 한다.
[출처: SRC-adaptive-logic@92f6e625#chunk-0007]

기술적으로 이는 **중간 단계 입력 UI**(진단 질문 응답, 전략 선택 버튼)가 필수적임을 의미한다. 아이의 최종 답만으로는 어떤 수감각이 부족한지 판별할 수 없으므로, 풀이 과정의 핵심 결정 지점에서 입력을 받아야 한다.

---

## 주요 기술 의사결정

### 규칙 기반 엔진 vs. ML 기반 적응형 시스템

**결정**: 규칙 기반 결정 트리 + 상태 머신

Adaptive Logic의 전체 로직이 W/C 수치 기반 필터링과 4가지 상태 전이로 완전히 정의되어 있다. ML 모델은 불필요하며, 오히려 비결정론적 출력이 교육적 일관성을 해칠 수 있다. 동일한 오답 패턴에 대해 항상 동일한 경로를 제시해야 치료 효과를 추적할 수 있다.

### 문제 뱅크 저장 전략

**결정**: 인메모리 캐시 + RDBMS 백업

15,053문제(W1~W6, W_총점, W 레벨, C 레벨 포함)는 약 2~5MB 규모이다. C 레벨별로 사전 정렬된 배열을 메모리에 로드하고, W_총점 기준 이진 검색으로 O(log N) 쿼리를 보장한다. 이 크기라면 클라이언트(모바일/웹)에서도 전체 데이터를 로드할 수 있어, 오프라인 모드 지원이 가능하다.

### 피드백 시스템: 템플릿 기반

**결정**: 사전 검수된 템플릿 풀 + 변수 슬롯

피드백 톤 가이드는 3문장 이내, 문장당 10자 이내, 비난/재촉/비교 금지라는 엄격한 제약을 둔다. LLM 자유 생성은 이 제약을 위반할 리스크가 있으므로, 상황별(정답/오답/실수/무응답) 4개 템플릿 풀에서 문구를 선택하고 숫자/연산자만 동적으로 채우는 방식이 안전하다.
[출처: prd-template-voice-tone-guide/chunk-0000]

### 진단 질문 입력 방식

**결정**: MVP에서는 객관식(2~3개 선택지), Phase 2에서 음성 인식 확장

초등 저학년 아동이 진단 질문("8이 10이 되려면 얼마가 필요해?")에 자유 텍스트로 응답하는 것은 현실적으로 어렵다. 객관식 버튼으로 응답을 수집하면 경로 분기(Path A/B) 판정의 정확성을 보장할 수 있다. STT+NLU 기반 자유 응답 분석은 정확도 검증 후 도입한다.

---

## 통합 포인트 (외부 시스템)

### 시각적 보조 렌더링 엔진

알고리즘 명세에서 10 프레임(계란판), 동전 모델, 기찻길 모델 등 다양한 시각적 보조가 Downscaling 전략으로 사용된다. 이를 위해 Canvas/SVG 기반 인터랙티브 렌더링 엔진이 필요하며, 시각 보조의 on/off를 Adaptive Logic의 Downscaling/Upscaling 상태와 연동해야 한다.

### TTS (Text-to-Speech) 엔진

피드백 톤 가이드의 음성 출력을 위해 한국어 아동 친화적 TTS가 필요하다. 템플릿 기반 피드백 문구의 길이가 짧으므로(최대 3문장, 30자 이내), TTS 지연은 문제가 되지 않으나 음색의 따뜻함과 자연스러움이 핵심 품질 요소이다.

### 세션 동기화 서비스

3단계 복귀 루프, Downscaling/Upscaling 상태, 현재 W/C 위치 등의 세션 컨텍스트가 기기 간 동기화되어야 한다. 아이가 태블릿에서 시작한 세션을 데스크톱에서 이어갈 수 있어야 하므로, 서버 사이드 세션 저장소(Redis 또는 DB)가 필요하다.

---

## 비기능 요구사항

### 성능

| 지표 | 목표값 | 근거 |
|------|--------|------|
| RT 측정 정밀도 | < 10ms 오차 | 5초 임계값 기반 분기에 영향 |
| 문제 선택 쿼리 | < 50ms | C/W 복합 필터링 실시간 처리 |
| 세션 상태 저장 | < 100ms | 3단계 루프 컨텍스트 유실 방지 |
| 피드백 렌더링 | < 200ms | 아동 집중력 유지 |

### 보안

- 아동 개인정보보호(COPPA/PIPA) 준수: 익명 UUID, 최소 수집 원칙
- 세션 데이터(RT, 응답 이력) 암호화 저장
- 학부모 동의 플로우 필수 탑재

### 확장성

| 항목 | 현재 | 확장 방향 |
|------|------|----------|
| 문제 뱅크 | 15,053개 (덧셈/뺄셈, C1~C15) | 곱셈/나눗셈 추가 시 C 레벨 확장 |
| W 레벨 | 1~23 (0.5 단위) | 새 연산 유형에 따른 W 가중치 재정의 |
| 진단 경로 | 2개 (Path A/B) | 전략 미숙, 주의력 결핍 등 추가 경로 |
| 시각 보조 | 10프레임, 동전, 가르기 선 | 3D 시각화, 게이미피케이션 요소 |

### 접근성 (아동 UX)

- 터치 우선 인터페이스: 큰 버튼(48px+), 드래그 앤 드롭 지원
- 시각 보조의 점진적 제거가 Upscaling과 연동되어야 함
- 피드백 톤: 반말이지만 부드럽게, 비난/재촉/비교 금지
[출처: prd-template-voice-tone-guide/chunk-0000]

---

## 리스크 요약

| ID | 리스크 | 영향도 | 완화 전략 |
|----|--------|--------|-----------|
| RSK-001 | 진단 질문 응답 분류 오류로 잘못된 경로 분기 | 높음 | MVP에서 객관식 입력, Phase 2에서 STT+NLU |
| RSK-002 | 복합 쿼리(C+W 동시 필터) 실시간 처리 지연 | 중간 | C 레벨별 사전 정렬 + W_총점 인메모리 인덱스 |
| RSK-003 | AI 피드백의 톤 가이드 위반 | 중간 | 템플릿 기반 + 금지어 필터, LLM 생성 금지 |
| RSK-004 | 반응 속도 측정의 디바이스별 편차 | 중간 | 클라이언트 사이드 로컬 타이머, 네트워크 지연 분리 |

---

## 미결 사항 (Open Questions)

1. **[높음]** 진단 질문의 입력 방식(STT vs. 객관식 vs. 자유 텍스트) 결정
2. **[높음]** 15,053문제 CSV의 업데이트 주기 및 배포 전략(앱 번들 vs. 서버 동적 로드)
3. **[중간]** 다중 사용자(교사-학생) 세션 관리 및 교사 대시보드 실시간 모니터링 필요 여부
4. **[중간]** 시각적 보조(10 프레임, 동전 모델)의 렌더링 기술(Canvas/SVG/정적 이미지) 결정

---

*이 문서는 증거 자료(Adaptive Logic 알고리즘, W/C 이중태그 문제 뱅크, Path-Tag 데이터 스키마, AI 피드백 톤 가이드)를 기반으로 작성되었습니다.*
