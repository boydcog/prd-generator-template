# **\[프로젝트명\] Tech Spec**

## **1\. 기술 개요 & 스택**

### **1-1. 기술 스택**

| 레이어 | 기술 | 버전 | 선택 이유 |
| ----- | ----- | ----- | ----- |
| **Frontend** | \[Next.js / React / 기타\] | \[버전\] | \[이유\] |
| **UI** | shadcn/ui \+ Tailwind CSS | \[버전\] | Zero-Design-Handoff |
| **Backend** | \[Next.js API Routes / FastAPI / 기타\] | \[버전\] | \[이유\] |
| **Database** | \[PostgreSQL / SQLite / 기타\] | \[버전\] | \[이유\] |
| **ORM** | \[Prisma / Drizzle / 기타\] | \[버전\] | \[이유\] |
| **Auth** | \[NextAuth / Clerk / 기타\] | \[버전\] | \[이유\] |
| **AI** | \[OpenAI / Anthropic / 기타\] | \[버전\] | \[이유\] |
| **호스팅** | \[Vercel / AWS / 기타\] | — | \[이유\] |

### **1-2. 기술 제약 조건**

| 제약 유형 | 내용 | 영향 |
| ----- | ----- | ----- |
| **규제** | \[해당 규제\] | \[구현 영향\] |
| **성능** | \[요구사항\] | \[아키텍처 영향\] |
| **외부 의존성** | \[필수 외부 서비스\] | \[대안 없는 의존성\] |

---

## **2\. 시스템 아키텍처**

### **2-1. 전체 아키텍처 다이어그램**

```
[사용자/클라이언트]
        ↓ HTTPS
[Frontend: Next.js App Router]
   ├── [페이지 컴포넌트]
   └── [API Routes / Server Actions]
              ↓
[Backend Logic]
   ├── [비즈니스 로직 레이어]
   └── [데이터 접근 레이어]
              ↓
[데이터 저장소: PostgreSQL 등]
              ↓
[외부 서비스: AI API 등]
```

### **2-2. 레이어별 책임**

| 레이어 | 책임 | 포함되지 않는 것 |
| ----- | ----- | ----- |
| **UI 레이어** | 화면 렌더링, 사용자 입력 | 비즈니스 로직 |
| **API 레이어** | 요청 검증, 응답 형식화 | 직접 DB 접근 |
| **비즈니스 로직** | 도메인 규칙, 워크플로우 | UI 의존성 |
| **데이터 레이어** | DB CRUD, 트랜잭션 | 비즈니스 규칙 |

### **2-3. 핵심 기능 데이터 흐름**

```
[시나리오: 핵심 기능 실행]

1. 사용자 → [액션] 실행
2. [컴포넌트] → POST /api/[endpoint]
3. API Route → zod 검증
4. API Route → [서비스].execute()
5. 서비스 → DB 쿼리
6. (필요시) 서비스 → AI API 호출
7. 결과 → JSON 응답 → UI 업데이트
```

---

## **3\. API 명세**

### **3-1. API 엔드포인트 목록**

| Method | Path | 설명 | 인증 | 관련 US |
| ----- | ----- | ----- | ----- | ----- |
| GET | /api/\[리소스\] | \[설명\] | \[Yes/No\] | US-001 |
| POST | /api/\[리소스\] | \[설명\] | \[Yes/No\] | US-002 |
| PUT | /api/\[리소스\]/\[id\] | \[설명\] | \[Yes/No\] | US-003 |
| DELETE | /api/\[리소스\]/\[id\] | \[설명\] | \[Yes/No\] | US-004 |

### **3-2. POST /api/\[리소스\]**

**목적:** \[설명\]

**요청**

```typescript
{
  field1: string,
  field2: number,
  field3?: string,
}
```

**응답 (성공 200)**

```typescript
{
  id: string,
  field1: string,
  createdAt: string,
}
```

**에러 응답**

```typescript
{
  error: {
    code: string,
    message: string,
  }
}
```

**에러 코드**

| HTTP | 에러 코드 | 의미 |
| ----- | ----- | ----- |
| 400 | VALIDATION\_ERROR | 입력값 오류 |
| 401 | UNAUTHORIZED | 인증 필요 |
| 404 | NOT\_FOUND | 리소스 없음 |
| 500 | INTERNAL\_ERROR | 서버 오류 |

### **3-3. GET /api/\[리소스\]/\[id\]**

**목적:** \[설명\]

**응답 (성공 200)**

```typescript
{
  id: string,
  [필드]: [타입],
}
```

### **3-4. 인증 & 인가**

| 항목 | 결정 | 구현 |
| ----- | ----- | ----- |
| **인증 방식** | \[JWT / Session / API Key\] | \[구현 방법\] |
| **세션 만료** | \[시간\] | \[갱신 정책\] |
| **역할 접근 제어** | \[Admin / User / Guest\] | \[미들웨어\] |

---

## **4\. 데이터 모델 & 스키마**

### **4-1. 핵심 엔티티**

| 엔티티 | 역할 | 관계 |
| ----- | ----- | ----- |
| \[엔티티1\] | \[설명\] | \[관계\] |
| \[엔티티2\] | \[설명\] | \[관계\] |

### **4-2. 데이터 스키마**

```prisma
model [엔티티1] {
  id        String   @id @default(cuid())
  [필드1]   String
  [필드2]   Int?
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  [관계필드] [엔티티2][]
}

model [엔티티2] {
  id        String   @id @default(cuid())
  [필드1]   String
  [외래키]  String
  createdAt DateTime @default(now())

  [관계필드] [엔티티1] @relation(fields: [[외래키]], references: [id])
}
```

### **4-3. 인덱스**

| 테이블 | 인덱스 필드 | 이유 |
| ----- | ----- | ----- |
| \[엔티티1\] | \[필드\] | \[조회 패턴\] |

---

## **5\. AI Rules & 가드레일**

### **5-1. 프로젝트 전역 Rules**

`.cursor/rules/project.md` 또는 `CLAUDE.md`에 저장.

```markdown
# [프로젝트명] AI Rules

## 아키텍처
- [규칙 1: 예) 모든 DB 접근은 /lib/db/ 레이어를 통해서만]
- [규칙 2: 예) API Routes는 비즈니스 로직을 포함하지 않는다]
- [규칙 3: 예) 서버 컴포넌트를 기본으로, 인터랙션이 필요한 경우만 "use client"]

## 코딩 컨벤션
- TypeScript strict 모드. any 타입 금지.
- 파일명: kebab-case. 컴포넌트: PascalCase.
- [기타 컨벤션]

## 금지 사항
- [예: 환경 변수 하드코딩 금지]
- [예: console.log 프로덕션 코드 잔류 금지]

## 보안
- [예: 사용자 입력은 항상 zod로 검증]
- [예: SQL은 ORM을 통해서만 실행]
```

### **5-2. \[도메인\] Rules**

```markdown
## [도메인] 구현 규칙

- [규칙 1]
- [규칙 2]

## 금지
- [금지 1]
```

### **5-3. AI 코딩 워크플로우**

| 단계 | AI 입력 | AI 출력 | 엔지니어 판단 |
| ----- | ----- | ----- | ----- |
| Feature 개발 | Product Spec AC \+ §5 Rules | 구현 코드 | 아키텍처, 코드 리뷰 |
| API 개발 | §3 API 명세 \+ Rules | API Route 코드 | 보안 검토 |
| DB 접근 | §4 스키마 \+ Rules | Prisma 쿼리 | 성능, N+1 방지 |
| 테스트 | 구현 코드 \+ AC | 테스트 코드 | 경계 케이스 추가 |

---

## **6\. 보안 & 성능 요구사항**

### **6-1. 보안**

| 항목 | 요구사항 | 구현 방법 |
| ----- | ----- | ----- |
| **인증** | \[요구사항\] | \[구현\] |
| **입력 검증** | 모든 API 입력 zod 검증 | zod 스키마 |
| **SQL Injection** | ORM 사용, raw query 금지 | Prisma |
| **민감 데이터** | 환경 변수, 로그 마스킹 | \[구현\] |

### **6-2. 성능 목표**

| 지표 | 목표값 | 측정 |
| ----- | ----- | ----- |
| **API 응답 시간** | \[ms — P95\] | \[도구\] |
| **페이지 로드 (LCP)** | \[ms\] | Lighthouse |
| **동시 사용자** | \[명\] | \[부하 테스트\] |

### **6-3. 에러 처리**

| 에러 유형 | 처리 방식 | 사용자 노출 |
| ----- | ----- | ----- |
| **입력 오류** | 즉시 반환 \+ 필드별 메시지 | 구체적 안내 |
| **인증 오류** | 401 \+ 로그인 리디렉션 | "다시 로그인 필요" |
| **서버 오류** | 에러 로깅 \+ 500 | "잠시 후 다시 시도" |
| **외부 API 오류** | 재시도 (3회) \+ 폴백 | \[폴백 동작\] |

---

## **7\. 인프라 & 배포**

### **7-1. 환경 구성**

| 환경 | 목적 | URL | 배포 |
| ----- | ----- | ----- | ----- |
| **local** | 개발 | localhost:3000 | `npm run dev` |
| **staging** | QA | \[URL\] | \[방식\] |
| **production** | 실서비스 | \[URL\] | \[방식\] |

### **7-2. 환경 변수**

| 변수명 | 설명 | 필수 |
| ----- | ----- | ----- |
| DATABASE\_URL | DB 연결 문자열 | 필수 |
| NEXTAUTH\_SECRET | 인증 비밀키 | 필수 |
| \[API\_KEY\] | \[외부 서비스 키\] | 필수 |

### **7-3. CI/CD**

| 단계 | 트리거 | 액션 |
| ----- | ----- | ----- |
| **테스트** | PR 생성 | 단위 테스트 \+ 타입 체크 |
| **배포 (staging)** | main 머지 | 자동 배포 |
| **배포 (production)** | 태그 생성 | 수동 승인 후 배포 |

---

## **8\. 기술 리스크 & PoC 결과**

### **8-1. PoC 검증 결과**

| 리스크 | 검증 방법 | 결과 | 결정 |
| ----- | ----- | ----- | ----- |
| \[기술 리스크 1\] | \[PoC 방법\] | \[Pass/Fail\] | \[채택/대안\] |
| \[기술 리스크 2\] | \[검증\] | \[결과\] | \[결정\] |

### **8-2. 잔존 리스크**

| 리스크 | 발생 가능성 | 영향도 | 대응 |
| ----- | ----- | ----- | ----- |
| \[리스크\] | \[상/중/하\] | \[상/중/하\] | \[완화 방법\] |

### **8-3. 외부 의존성**

| 서비스 | 용도 | 대안 |
| ----- | ----- | ----- |
| \[서비스\] | \[용도\] | \[없음/있음\] |

---

## **Gate 4 자가 점검**

| 기준 | 질문 | 판정 |
| ----- | ----- | ----- |
| **완성도** | §1~§8 전 섹션 완성되었는가? | \[Pass/Fail\] |
| **구현 가능성** | 이 Spec대로 4주 내 구현 가능한가? | \[Pass/Fail\] |
| **Product Spec 정합** | Product Spec AC와 API 명세가 매핑되는가? | \[Pass/Fail\] |
| **Design Spec 정합** | Design Spec 기술 스택과 §1 스택이 일치하는가? | \[Pass/Fail\] |
| **AI Rules 완성** | §5 Rules로 AI 코딩 도구 가드레일 적용 가능한가? | \[Pass/Fail\] |
| **3자 합의** | PM · 디자이너 · 엔지니어 전원 합의했는가? | \[Pass/Fail\] |

* **판정:** \[Freeze 확정 / 수정 후 재검토\]
* **확정자:** \[이름들\] (날짜: YYYY-MM-DD)
