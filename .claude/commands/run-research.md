# /run-research â€” ì—ì´ì „íŠ¸ íŒ€ ì˜¤ì¼€ìŠ¤íŠ¸ë ˆì´ì…˜

ì—ì´ì „íŠ¸ íŒ€ì„ ì‹¤í–‰í•˜ì—¬ ì¦ê±° ê¸°ë°˜ ë¬¸ì„œë¥¼ ìƒì„±í•©ë‹ˆë‹¤.
ë¬¸ì„œ ìœ í˜•ì— ë”°ë¼ í™œì„± ì—ì´ì „íŠ¸, ì¶œë ¥ êµ¬ì¡°, ì €ì¥ ê²½ë¡œê°€ ë™ì ìœ¼ë¡œ ê²°ì •ë©ë‹ˆë‹¤.
ê° ì‹¤í–‰ì€ ìƒˆ ë²„ì „(v1, v2, ...)ìœ¼ë¡œ ì €ì¥ë©ë‹ˆë‹¤.

---

## ì‚¬ì „ ì¡°ê±´ í™•ì¸

ì‹¤í–‰ ì „ ë‹¤ìŒì„ í™•ì¸í•©ë‹ˆë‹¤:

1. **project.json ì¡´ì¬**: `.claude/state/project.json`ì´ ìˆëŠ”ì§€ í™•ì¸. ì—†ìœ¼ë©´ `/init-project`ë¥¼ ë¨¼ì € ì‹¤í–‰í•˜ë¼ê³  ì•ˆë‚´.
2. **ì¦ê±° ì¸ë±ìŠ¤ ì¡´ì¬**: `.claude/knowledge/evidence/index/sources.jsonl`ì´ ìˆëŠ”ì§€ í™•ì¸. ì—†ìœ¼ë©´ `/sync-drive`ë¥¼ ë¨¼ì € ì‹¤í–‰í•˜ë¼ê³  ì•ˆë‚´.
3. **ì¦ê±° ë¹„ì–´ìˆì§€ ì•ŠìŒ**: sources.jsonlì— ìµœì†Œ 1ê°œ í•­ëª©ì´ ìˆëŠ”ì§€ í™•ì¸.

### Step 0.5: ë¬¸ì„œ ìœ í˜• ì„¤ì • ë¡œë“œ

1. `project.json`ì—ì„œ `document_type` í•„ë“œë¥¼ ì½ìŠµë‹ˆë‹¤.
   - í•„ë“œê°€ ì—†ìœ¼ë©´ ê¸°ë³¸ê°’ `prd`ë¥¼ ì‚¬ìš©í•©ë‹ˆë‹¤ (í•˜ìœ„í˜¸í™˜).
2. `.claude/spec/document-types.yaml`ì—ì„œ í•´ë‹¹ ë¬¸ì„œ ìœ í˜•ì˜ ì„¤ì •ì„ ë¡œë“œí•©ë‹ˆë‹¤:
   - `agent_roles.wave1` â†’ Wave 1ì—ì„œ ì‹¤í–‰í•  ì—ì´ì „íŠ¸ ëª©ë¡
   - `allow_dynamic_roles` â†’ ë™ì  ì—­í•  ë¶„ì„ í™œì„±í™” ì—¬ë¶€
   - `output_dir_name` â†’ ì¶œë ¥ ë””ë ‰í† ë¦¬ ì´ë¦„
   - `output_file_name` â†’ ìµœì¢… ë¬¸ì„œ íŒŒì¼ëª…
   - `output_sections` â†’ synth ì—ì´ì „íŠ¸ì— ì „ë‹¬í•  ë¬¸ì„œ êµ¬ì¡°

### Step 0.6: ì—ì´ì „íŠ¸ ì—­í•  ì í•©ì„± ë¶„ì„

> ì´ ë‹¨ê³„ëŠ” `document-types.yaml`ì˜ `allow_dynamic_roles`ê°€ `true`ì¼ ë•Œë§Œ ì‹¤í–‰í•©ë‹ˆë‹¤.
> `false`ì´ë©´ (ì˜ˆ: custom ìœ í˜•) ì´ ë‹¨ê³„ë¥¼ ê±´ë„ˆë›°ê³  Step 0.7ë¡œ ì§„í–‰í•©ë‹ˆë‹¤.

#### 0. ì—ëŸ¬ í•¸ë“¤ë§

ì´ ë‹¨ê³„ì—ì„œ ì˜¤ë¥˜ ë°œìƒ ì‹œ ê¸°ì¡´ êµ¬ì„±ìœ¼ë¡œ ì•ˆì „í•˜ê²Œ í´ë°±í•©ë‹ˆë‹¤:
- `project.json` ì½ê¸° ì‹¤íŒ¨ ë˜ëŠ” í•„ìˆ˜ í•„ë“œ(`name`, `domain`) ëˆ„ë½ â†’ "í”„ë¡œì íŠ¸ ì •ë³´ê°€ ë¶€ì¡±í•˜ì—¬ ì—­í•  ë¶„ì„ì„ ê±´ë„ˆëœë‹ˆë‹¤." ì•ˆë‚´ í›„ Step 0.7ë¡œ ì§„í–‰
- `sources.jsonl` ì½ê¸° ì‹¤íŒ¨ â†’ ì¦ê±° ì†ŒìŠ¤ ì—†ì´ í”„ë¡œì íŠ¸ ì •ë³´ë§Œìœ¼ë¡œ ë¶„ì„ ì‹œë„
- ë¶„ì„ ì¤‘ ì˜ˆì™¸ â†’ "ì—­í•  ë¶„ì„ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí•˜ì—¬ ê¸°ì¡´ êµ¬ì„±ìœ¼ë¡œ ì§„í–‰í•©ë‹ˆë‹¤." ì•ˆë‚´ í›„ Step 0.7ë¡œ ì§„í–‰
- ì‚¬ìš©ìì—ê²Œ ë‚´ë¶€ íŒŒì¼ ê²½ë¡œ, ìŠ¤íƒ íŠ¸ë ˆì´ìŠ¤, ì¦ê±° ì†ŒìŠ¤ ì›ë¬¸ì„ ë…¸ì¶œí•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.

#### 1. ì…ë ¥ ìˆ˜ì§‘

ë‹¤ìŒ ì •ë³´ë¥¼ ìˆ˜ì§‘í•©ë‹ˆë‹¤:
- `project.json`: `name`, `domain`, `core_problem`, `constraints`, `research_questions`
- `sources.jsonl`: ì¦ê±° ì†ŒìŠ¤ ëª©ë¡ (ì œëª©, ìœ í˜•)
- `document-types.yaml`: í˜„ì¬ ë¬¸ì„œ ìœ í˜•ì˜ `agent_roles.wave1` ì—ì´ì „íŠ¸ ëª©ë¡

#### 2. ê¸°ì¡´ dynamic_roles í™•ì¸

`project.json`ì— `dynamic_roles` ë°°ì—´ì´ ì´ë¯¸ ìˆëŠ” ê²½ìš°:
- AskUserQuestionìœ¼ë¡œ í™•ì¸í•©ë‹ˆë‹¤:
  > "ì´ì „ ì‹¤í–‰ì—ì„œ ì¶”ê°€ëœ ì—­í• ì´ ìˆìŠµë‹ˆë‹¤: {ì—­í•  ëª©ë¡}. ìœ ì§€í• ê¹Œìš”?"
- ì„ íƒì§€: "ìœ ì§€" / "ì¬ë¶„ì„"
- "ìœ ì§€" ì„ íƒ ì‹œ â†’ Step 0.7ë¡œ ì§„í–‰
- "ì¬ë¶„ì„" ì„ íƒ ì‹œ â†’ ì•„ë˜ ë¶„ì„ ê³„ì†

#### 3. ì—­í•  ê°­ ë¶„ì„

Claudeê°€ ì§ì ‘ ìˆ˜í–‰í•©ë‹ˆë‹¤ (ë³„ë„ ì—ì´ì „íŠ¸ ì—†ìŒ):

1. í”„ë¡œì íŠ¸ì˜ ë„ë©”ì¸, í•µì‹¬ ë¬¸ì œ, ì œì•½ì‚¬í•­, ì¦ê±° ì†ŒìŠ¤ ì œëª©ì„ ë¶„ì„í•©ë‹ˆë‹¤.
2. ê¸°ì¡´ wave1 ì—­í• ì´ ì»¤ë²„í•˜ëŠ” ì˜ì—­ì„ íŒŒì•…í•©ë‹ˆë‹¤:
   - `biz`: ë¹„ì¦ˆë‹ˆìŠ¤ ëª©í‘œ, ì„±ê³µ ì§€í‘œ, ê²½ìŸ í™˜ê²½, ì‹œì¥ ê¸°íšŒ
   - `marketing`: í¬ì§€ì…”ë‹, ë©”ì‹œì§•, ì±„ë„ ì „ëµ, ëŸ°ì¹­ ê³„íš
   - `research`: ì‚¬ìš©ì ì¸ì‚¬ì´íŠ¸, ì¦ê±° ë§µ, ê°€ì • ê²€ì¦
   - `tech`: ê¸°ìˆ  íƒ€ë‹¹ì„±, ì•„í‚¤í…ì²˜, ë¹„ê¸°ëŠ¥ ìš”êµ¬ì‚¬í•­
   - `pm`: ìŠ¤ì½”í”„, ìš”êµ¬ì‚¬í•­, ë§ˆì¼ìŠ¤í†¤, ìˆ˜ìš© ê¸°ì¤€
3. í”„ë¡œì íŠ¸ì— í•„ìš”í•˜ì§€ë§Œ ê¸°ì¡´ ì—­í• ë¡œ ì»¤ë²„ë˜ì§€ ì•ŠëŠ” ì˜ì—­ì„ ì‹ë³„í•©ë‹ˆë‹¤.
4. ì»¤ë²„ë˜ì§€ ì•ŠëŠ” ì˜ì—­ì´ ìˆìœ¼ë©´ ë™ì  ì—­í• ì„ ì œì•ˆí•©ë‹ˆë‹¤.
   - ìµœëŒ€ 3ê°œê¹Œì§€ ì œì•ˆí•©ë‹ˆë‹¤.
   - ê° ì—­í• ì˜ í˜•ì‹:
     ```
     role_id: ì˜ë¬¸ ì†Œë¬¸ì (ì˜ˆ: "ops", "pedagogy", "regulatory")
     name: í•œêµ­ì–´ ì—­í• ëª… (ì˜ˆ: "ìš´ì˜/í”„ë¡œì„¸ìŠ¤")
     responsibility: ì±…ì„ ë²”ìœ„ ì„¤ëª…
     keywords: ì¦ê±° ë¶„ë°°ìš© í‚¤ì›Œë“œ ë°°ì—´
     output_sections: í•´ë‹¹ ì—­í• ì˜ í•„ìˆ˜ ì¶œë ¥ ì„¹ì…˜ ë°°ì—´
     ```

#### 4. ì œì•ˆì´ ì—†ëŠ” ê²½ìš°

- "ê¸°ì¡´ ì—ì´ì „íŠ¸ êµ¬ì„±ì´ ì´ í”„ë¡œì íŠ¸ì— ì í•©í•©ë‹ˆë‹¤." ë¡œê·¸ í›„ Step 0.7ë¡œ ì§„í–‰í•©ë‹ˆë‹¤.

#### 5. ì œì•ˆì´ ìˆëŠ” ê²½ìš°

AskUserQuestionìœ¼ë¡œ ì‚¬ìš©ì ìŠ¹ì¸ì„ ë°›ìŠµë‹ˆë‹¤:
> "í”„ë¡œì íŠ¸ ë¶„ì„ ê²°ê³¼, ë‹¤ìŒ ì—­í• ì„ ì¶”ê°€í•˜ë©´ ë” í¬ê´„ì ì¸ ë¬¸ì„œë¥¼ ìƒì„±í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤:"

ê° ì—­í• ì˜ ID, ì´ë¦„, ì±…ì„ ë²”ìœ„ë¥¼ í‘œì‹œí•©ë‹ˆë‹¤.
ì„ íƒì§€: "ëª¨ë‘ ì¶”ê°€" / "ì„ íƒì  ì¶”ê°€" / "ê¸°ì¡´ êµ¬ì„± ìœ ì§€"
- "ì„ íƒì  ì¶”ê°€" ì‹œ multiSelectë¡œ ê°œë³„ ì—­í•  ì„ íƒ ê°€ëŠ¥

#### 6. ì—­í•  ID ê²€ì¦

ìŠ¹ì¸ëœ ê° ì—­í• ì— ëŒ€í•´ ì €ì¥ ì „ ê²€ì¦í•©ë‹ˆë‹¤:
- `role_id`ê°€ `/^[a-z][a-z0-9-]*$/` íŒ¨í„´ì— ë§ëŠ”ì§€ í™•ì¸ (ì˜ë¬¸ ì†Œë¬¸ì ì‹œì‘, ì†Œë¬¸ì/ìˆ«ì/í•˜ì´í”ˆë§Œ í—ˆìš©)
- ê¸°ì¡´ ì—­í•  ID(`biz`, `marketing`, `research`, `tech`, `pm`, `synth`)ì™€ ì¤‘ë³µë˜ì§€ ì•ŠëŠ”ì§€ í™•ì¸
- `name`, `responsibility`ê°€ ë¹ˆ ë¬¸ìì—´ì´ ì•„ë‹Œì§€ í™•ì¸
- `keywords` ë°°ì—´ì— ìµœì†Œ 1ê°œ í•­ëª©ì´ ìˆëŠ”ì§€ í™•ì¸
- `output_sections` ë°°ì—´ì— ìµœì†Œ 1ê°œ í•­ëª©ì´ ìˆëŠ”ì§€ í™•ì¸
- ê²€ì¦ ì‹¤íŒ¨ ì‹œ í•´ë‹¹ ì—­í• ì„ ì œì™¸í•˜ê³  "ì—­í•  '{role_id}' í˜•ì‹ì´ ì˜¬ë°”ë¥´ì§€ ì•Šì•„ ì œì™¸ë˜ì—ˆìŠµë‹ˆë‹¤." ì•ˆë‚´

#### 7. ìŠ¹ì¸ëœ ì—­í•  ì €ì¥

- `project.json`ì— `dynamic_roles` ë°°ì—´ì„ ì¶”ê°€(ë˜ëŠ” ê°±ì‹ )í•©ë‹ˆë‹¤.
- ê° í•­ëª©: `{ role_id, name, responsibility, keywords, output_sections }`
- ê¸°ì¡´ `agent_roles` ë°°ì—´ì´ ìˆìœ¼ë©´ ë™ì  ì—­í•  IDë„ ì¶”ê°€í•©ë‹ˆë‹¤.
- ê°ì‚¬ ì¶”ì : `dynamic_roles_meta` ê°ì²´ë„ í•¨ê»˜ ì €ì¥í•©ë‹ˆë‹¤:
  ```json
  {
    "updated_by": "<.user-identity ê°’>",
    "updated_at": "<ISO 8601 íƒ€ì„ìŠ¤íƒ¬í”„>",
    "action": "add|reanalyze|keep",
    "previous_roles": ["<ì´ì „ role_id ëª©ë¡, ì—†ìœ¼ë©´ ë¹ˆ ë°°ì—´>"]
  }
  ```

#### 8. í›„ì† ë‹¨ê³„ ì—°ë™

- Step 0.7: ë™ì  ì—­í• ì˜ `keywords`ë¥¼ ì‚¬ìš©í•˜ì—¬ ì¶”ê°€ ì²­í¬ ë¶„ë°°
- Wave 1: ë™ì  ì—­í• ë„ ê¸°ì¡´ ì—ì´ì „íŠ¸ì™€ í•¨ê»˜ Task toolë¡œ ë³‘ë ¬ ì‹¤í–‰
- Wave 2 (Synth): ë™ì  ì—ì´ì „íŠ¸ ì¶œë ¥ë„ í†µí•© ëŒ€ìƒì— í¬í•¨

---

## ë²„ì „ ê´€ë¦¬

### ë²„ì „ ë²ˆí˜¸ ê²°ì •

1. `.claude/artifacts/{output_dir_name}/` ë””ë ‰í† ë¦¬ì—ì„œ ê¸°ì¡´ ë²„ì „ í´ë”ë¥¼ í™•ì¸í•©ë‹ˆë‹¤ (`v1/`, `v2/`, ...).
   - `{output_dir_name}`ì€ `document-types.yaml`ì—ì„œ ë¡œë“œí•œ ê°’ì…ë‹ˆë‹¤.
2. ê°€ì¥ ë†’ì€ ë²ˆí˜¸ + 1ì„ ìƒˆ ë²„ì „ìœ¼ë¡œ ì‚¬ìš©í•©ë‹ˆë‹¤.
3. ì²« ì‹¤í–‰ì´ë©´ `v1`ì…ë‹ˆë‹¤.

### ì¶œë ¥ ê²½ë¡œ êµ¬ì¡°

```
.claude/artifacts/{output_dir_name}/
â”œâ”€â”€ v1/
â”‚   â”œâ”€â”€ {output_file_name}
â”‚   â”œâ”€â”€ citations.json
â”‚   â”œâ”€â”€ conflicts.json
â”‚   â””â”€â”€ metadata.json       # ë²„ì „ ë©”íƒ€ë°ì´í„°
â”œâ”€â”€ v2/
â”‚   â”œâ”€â”€ {output_file_name}
â”‚   â”œâ”€â”€ ...
â””â”€â”€ latest -> v2/           # (ì‹¬ë³¼ë¦­ ë§í¬ ë˜ëŠ” latest.jsonìœ¼ë¡œ ìµœì‹  ë²„ì „ ì°¸ì¡°)
```

### ë²„ì „ ë©”íƒ€ë°ì´í„° (`metadata.json`)

```json
{
  "version": 2,
  "created_at": "2024-01-15T09:30:00Z",
  "evidence_index_sha256": "<sha256>",
  "source_count": 3,
  "project_name": "<í”„ë¡œì íŠ¸ëª…>"
}
```

---

## ì‹¤í–‰ ì ˆì°¨

### Step 0.7: ì¦ê±° ì‚¬ì „ ë¡œë“œ ë° ì—­í• ë³„ ë¶„ë°°

Wave 1 ì—ì´ì „íŠ¸ ì‹¤í–‰ ì „ì— ì¦ê±°ë¥¼ í•œ ë²ˆë§Œ ì½ê³  ì—­í• ë³„ë¡œ ë¶„ë°°í•©ë‹ˆë‹¤. ì—ì´ì „íŠ¸ë‹¹ ì»¨í…ìŠ¤íŠ¸ë¥¼ 60~70% ì¤„ì—¬ ì„±ëŠ¥ì„ ë†’ì…ë‹ˆë‹¤.

1. `sources.jsonl`ê³¼ ì „ì²´ ì²­í¬ë¥¼ í•œ ë²ˆë§Œ ì½ìŠµë‹ˆë‹¤.
2. ê° ì²­í¬ë¥¼ í‚¤ì›Œë“œ/ì£¼ì œë¡œ ë¶„ë¥˜í•˜ì—¬ ì—­í• ë³„ ê´€ë ¨ ì²­í¬ë¥¼ ë¶„ë°°í•©ë‹ˆë‹¤:
   - ë¹„ì¦ˆë‹ˆìŠ¤/ì‹œì¥/ë§¤ì¶œ/KPI/ê²½ìŸ â†’ `biz`, `marketing`
   - ì‚¬ìš©ì/ì¸ì‚¬ì´íŠ¸/ì„¤ë¬¸/í˜ë¥´ì†Œë‚˜ â†’ `research`
   - ê¸°ìˆ /ì•„í‚¤í…ì²˜/API/ì¸í”„ë¼/ì„±ëŠ¥ â†’ `tech`
   - ìš”êµ¬ì‚¬í•­/ì¼ì •/ë§ˆì¼ìŠ¤í†¤/ìŠ¤ì½”í”„ â†’ `pm`
   - **ë™ì  ì—­í• **: `project.json`ì˜ `dynamic_roles[].keywords`ë¥¼ ì½ì–´ ì¶”ê°€ ë§¤í•‘ ìƒì„±
   - ë¶„ë¥˜ ë¶ˆê°€ â†’ ëª¨ë“  ì—ì´ì „íŠ¸ì— ì „ë‹¬
3. ì—ì´ì „íŠ¸ í”„ë¡¬í”„íŠ¸ì— íŒŒì¼ ê²½ë¡œ ëŒ€ì‹  **ì‚¬ì „ ì¡°í•©ëœ í…ìŠ¤íŠ¸**ë¥¼ ì „ë‹¬í•©ë‹ˆë‹¤.

### Step 0.8: ëª¨ë¸ ê²°ì •

`.claude/spec/model-selection-spec.md`ì˜ `resolveModel` ì•Œê³ ë¦¬ì¦˜ì— ë”°ë¼ ê° ì—ì´ì „íŠ¸ì˜ ëª¨ë¸ì„ ê²°ì •í•©ë‹ˆë‹¤.

1. `project.json`ì—ì„œ `model_overrides` í•„ë“œë¥¼ í™•ì¸í•©ë‹ˆë‹¤ (ì—†ìœ¼ë©´ ê±´ë„ˆëœ€).
2. `document-types.yaml`ì—ì„œ í˜„ì¬ ë¬¸ì„œ ìœ í˜•ì˜ `model_overrides` í•„ë“œë¥¼ í™•ì¸í•©ë‹ˆë‹¤ (ì—†ìœ¼ë©´ ê±´ë„ˆëœ€).
3. ì˜¤ë²„ë¼ì´ë“œê°€ ì—†ìœ¼ë©´ ê¸°ë³¸ê°’ì„ ì ìš©í•©ë‹ˆë‹¤:
   - Wave 1 ì—ì´ì „íŠ¸ (ê³ ì • + ë™ì ): `sonnet`
   - Wave 2 ì—ì´ì „íŠ¸ (synth): `opus`
4. ê²°ì •ëœ ëª¨ë¸ì´ `opus`, `sonnet`, `haiku` ì¤‘ í•˜ë‚˜ì¸ì§€ ê²€ì¦í•©ë‹ˆë‹¤. ìœ íš¨í•˜ì§€ ì•Šìœ¼ë©´ í•´ë‹¹ waveì˜ ê¸°ë³¸ê°’ìœ¼ë¡œ í´ë°±í•©ë‹ˆë‹¤.

---

### Wave 0: íŒ€ êµ¬ì„±

1. `TeamCreate(team_name="research-v{N}")`ë¡œ íŒ€ì„ ìƒì„±í•©ë‹ˆë‹¤.
2. Wave 1 ì—­í• ë§ˆë‹¤ `TaskCreate` í˜¸ì¶œ:
   - subject: "{role_name} ë¶„ì„ ìˆ˜í–‰"
   - activeForm: "{role_name} ë¶„ì„ ì¤‘"
3. Synthìš© `TaskCreate` + `TaskUpdate(addBlockedBy=[ëª¨ë“  wave1 task ID])`

### Wave 1: íŒ€ì› ë³‘ë ¬ ìƒì„± (ë™ì )

`document-types.yaml`ì˜ `agent_roles.wave1`ì— ì •ì˜ëœ ì—ì´ì „íŠ¸ + `project.json`ì˜ `dynamic_roles`ì— ì •ì˜ëœ ë™ì  ì—ì´ì „íŠ¸ë¥¼ í•©ì‚°í•˜ì—¬ TeamCreate íŒ€ì›ìœ¼ë¡œ **ë³‘ë ¬** ìƒì„±í•©ë‹ˆë‹¤.

ëª¨ë“  Wave 1 ì—­í• ì— ëŒ€í•´ **ë™ì‹œì—** Task tool í˜¸ì¶œ:

```
Task(
  team_name="research-v{N}",
  name="{role}-agent",
  subagent_type="general-purpose",
  prompt="... (ì—ì´ì „íŠ¸ í”„ë¡¬í”„íŠ¸ + íŒ€ í†µì‹  ë¸”ë¡)\n\nğŸ¤– ê¶Œì¥ ëª¨ë¸: sonnet (Step 0.8ì—ì„œ ê²°ì •)"
)
```

> **ì£¼ì˜**: Task toolì—ì„œ ëª…ì‹œì  ëª¨ë¸ ì§€ì •ì„ ì§€ì›í•˜ì§€ ì•Šìœ¼ë¯€ë¡œ, í”„ë¡¬í”„íŠ¸ ë‚´ "ê¶Œì¥ ëª¨ë¸" ì•ˆë‚´ëŠ” ì°¸ê³ ì‚¬í•­ì…ë‹ˆë‹¤.
> ì‹¤ì œ ëª¨ë¸ ì„ íƒì€ ì—ì´ì „íŠ¸ì˜ ê¸°ë³¸ ë™ì‘ì„ ë”°ë¦…ë‹ˆë‹¤.

ê° ì—ì´ì „íŠ¸ì—ê²Œ ì „ë‹¬í•  ì»¨í…ìŠ¤íŠ¸:
- `.claude/state/project.json` (í”„ë¡œì íŠ¸ ì„¤ì •)
- `.claude/knowledge/evidence/index/sources.jsonl` (ì¦ê±° ì¸ë±ìŠ¤)
- `.claude/knowledge/evidence/chunks/` (ì¦ê±° ì²­í¬ íŒŒì¼ë“¤)
- `.claude/spec/agent-team-spec.md` (ì—­í•  ì •ì˜ ë° JSON ê³„ì•½)
- `.claude/spec/citation-spec.md` (ì¸ìš© ê·œì¹™)
- `.claude/spec/document-types.yaml` (ë¬¸ì„œ ìœ í˜• ì •ì˜)

#### íŒ€ì› ì‹¤í–‰ ì ˆì°¨

1. `TaskList` â†’ ìê¸° íƒœìŠ¤í¬ ì°¾ê¸°
2. `TaskUpdate(owner, status=in_progress)`
3. ì¦ê±° ë¶„ì„ + JSON/MD íŒŒì¼ ìƒì„±
4. `TaskUpdate(status=completed)`
5. `SendMessage(recipient="team-lead", summary="{role} ë¶„ì„ ì™„ë£Œ")`
6. `shutdown_request` ëŒ€ê¸° â†’ ìŠ¹ì¸

#### ì—ì´ì „íŠ¸ ëª©ë¡ (ë¬¸ì„œ ìœ í˜•ì— ë”°ë¼ í™œì„±í™”)

| Role ID | ì—ì´ì „íŠ¸ | ì—­í•  | ì¶œë ¥ |
|---------|---------|------|------|
| `biz` | Biz/Strategy Agent | ë¹„ì¦ˆë‹ˆìŠ¤ ëª©í‘œ, ì„±ê³µ ì§€í‘œ, ê²½ìŸ í™˜ê²½ ë¶„ì„ | `agents/biz.json` + `agents/biz.md` |
| `marketing` | Marketing/GTM Agent | í¬ì§€ì…”ë‹, ë©”ì‹œì§•, ëŸ°ì¹­ ì „ëµ | `agents/marketing.json` + `agents/marketing.md` |
| `research` | Research Agent | ì‚¬ìš©ì ì¸ì‚¬ì´íŠ¸, ì¦ê±° ë§µ, ê°€ì • ê²€ì¦ | `agents/research.json` + `agents/research.md` |
| `tech` | Tech Agent | ê¸°ìˆ  íƒ€ë‹¹ì„±, ì•„í‚¤í…ì²˜, ë¹„ê¸°ëŠ¥ ìš”êµ¬ì‚¬í•­ | `agents/tech.json` + `agents/tech.md` |
| `pm` | PM Agent | ìŠ¤ì½”í”„, ìš”êµ¬ì‚¬í•­, ë§ˆì¼ìŠ¤í†¤, ìˆ˜ìš© ê¸°ì¤€ | `agents/pm.json` + `agents/pm.md` |

ì˜ˆì‹œ: `document_type: marketing-brief`ì´ë©´ biz, marketing, researchë§Œ ì‹¤í–‰.

#### ë™ì  ì—­í•  ì—ì´ì „íŠ¸

`project.json`ì— `dynamic_roles`ê°€ ìˆìœ¼ë©´ í•´ë‹¹ ì—­í• ë„ Wave 1ì— í¬í•¨í•˜ì—¬ íŒ€ì›ìœ¼ë¡œ ë³‘ë ¬ ìƒì„±í•©ë‹ˆë‹¤.
ë™ì  ì—­í•  ì—ì´ì „íŠ¸ì˜ í”„ë¡¬í”„íŠ¸ëŠ” ê¸°ì¡´ í…œí”Œë¦¿ê³¼ ë™ì¼í•˜ë˜:
- ì—­í•  ì •ì˜ë¥¼ `agent-team-spec.md` ëŒ€ì‹  `dynamic_roles[]`ì—ì„œ ë¡œë“œ
- í•„ìˆ˜ ì„¹ì…˜ì„ `dynamic_roles[].output_sections`ì—ì„œ ë¡œë“œ
- ì¶œë ¥ ê²½ë¡œ: `.claude/artifacts/agents/{role_id}.json` + `{role_id}.md`

### Wave 2: Synth íŒ€ì› ìƒì„± (ìˆœì°¨, Wave 1 ì™„ë£Œ í›„)

`TaskList`ë¡œ synth íƒœìŠ¤í¬ì˜ `blockedBy` í•´ì†Œë¥¼ í™•ì¸í•œ í›„ synth íŒ€ì›ì„ ìƒì„±í•©ë‹ˆë‹¤.

```
Task(
  team_name="research-v{N}",
  name="synth-agent",
  subagent_type="general-purpose",
  prompt="... (synth í”„ë¡¬í”„íŠ¸ + íŒ€ í†µì‹  ë¸”ë¡)\n\nğŸ¤– ê¶Œì¥ ëª¨ë¸: opus (Step 0.8ì—ì„œ ê²°ì •)"
)
```

> **ì£¼ì˜**: Task toolì—ì„œ ëª…ì‹œì  ëª¨ë¸ ì§€ì •ì„ ì§€ì›í•˜ì§€ ì•Šìœ¼ë¯€ë¡œ, í”„ë¡¬í”„íŠ¸ ë‚´ "ê¶Œì¥ ëª¨ë¸" ì•ˆë‚´ëŠ” ì°¸ê³ ì‚¬í•­ì…ë‹ˆë‹¤.
> ì‹¤ì œ ëª¨ë¸ ì„ íƒì€ ì—ì´ì „íŠ¸ì˜ ê¸°ë³¸ ë™ì‘ì„ ë”°ë¦…ë‹ˆë‹¤.

- ì…ë ¥: Wave 1ì˜ ì—ì´ì „íŠ¸ JSON + MD ê²°ê³¼ë¬¼ ì „ì²´ (ë™ì  ì—­í•  ì¶œë ¥ í¬í•¨)
- ì—­í• : í†µí•©, ì¶©ëŒ í•´ê²°, ìµœì¢… ë¬¸ì„œ ì‘ì„±

##### Synth íŒ€ì› ì ˆì°¨:

1. `TaskList` â†’ "í†µí•© ë¬¸ì„œ ìƒì„± (synth)" íƒœìŠ¤í¬ í´ë ˆì„
2. `TaskUpdate(owner="synth-agent", status="in_progress")`
3. Wave 1 ê²°ê³¼ ì½ê¸° (ëª¨ë“  ì—­í• ì˜ JSON + MD)
4. **ì¶©ëŒ ì‹ë³„**: ì—­í•  ê°„ ìƒì¶©í•˜ëŠ” ì£¼ì¥ì„ ì‹ë³„í•©ë‹ˆë‹¤.
   - ì¶©ëŒ í•­ëª©ì€ `conflicts.json`ì— ê¸°ë¡í•©ë‹ˆë‹¤.
5. **í†µí•© ë¬¸ì„œ ì‘ì„±**: ëª¨ë“  ì—­í• (ê³ ì • + ë™ì )ì˜ í•µì‹¬ ë‚´ìš©ì„ í†µí•©í•˜ì—¬ ìµœì¢… ë¬¸ì„œë¥¼ ì‘ì„±í•©ë‹ˆë‹¤.
   - ë¬¸ì„œ êµ¬ì¡°ëŠ” `document-types.yaml`ì˜ `output_sections`ë¥¼ ë”°ë¦…ë‹ˆë‹¤.
   - `output_sections` ëª©ë¡ì„ ì‚¬ìš©í•˜ì—¬ í•´ë‹¹ ì„¹ì…˜ìœ¼ë¡œ ë¬¸ì„œë¥¼ êµ¬ì„±í•©ë‹ˆë‹¤.
   - ë™ì  ì—­í• ì˜ ê´€ì ì€ ê´€ë ¨ ì„¹ì…˜ì— ìì—°ìŠ¤ëŸ½ê²Œ í†µí•©í•©ë‹ˆë‹¤ (ë³„ë„ ì„¹ì…˜ì„ ë§Œë“¤ì§€ ì•ŠìŒ).
6. **ì¸ìš© ë³´ê³ ì„œ**: ëª¨ë“  ì¸ìš©ì„ `citations.json`ì— ê¸°ë¡í•©ë‹ˆë‹¤.
7. **ì¶œë ¥**: ë²„ì „ ë””ë ‰í† ë¦¬ì— `{output_file_name}` ì €ì¥
   - ê²½ë¡œ: `.claude/artifacts/{output_dir_name}/v{N}/{output_file_name}`
8. `TaskUpdate(status="completed")`
9. `SendMessage(recipient="team-lead", summary="í†µí•© ë¬¸ì„œ ìƒì„± ì™„ë£Œ")`

### Wave 3: íŒ€ ì •ë¦¬

1. ëª¨ë“  íŒ€ì›ì—ê²Œ `SendMessage(type="shutdown_request")` ì „ì†¡
2. ìŠ¹ì¸ ìˆ˜ì‹  í›„ `TeamDelete()` í˜¸ì¶œ

---

## ì—ì´ì „íŠ¸ í”„ë¡¬í”„íŠ¸ í…œí”Œë¦¿

### ê³ ì • ì—­í•  ì—ì´ì „íŠ¸ í”„ë¡¬í”„íŠ¸

```
ë‹¹ì‹ ì€ {role_name} ì „ë¬¸ê°€ì…ë‹ˆë‹¤.

## í”„ë¡œì íŠ¸ ì»¨í…ìŠ¤íŠ¸
{project.json ë‚´ìš©}

## ë‹¹ì‹ ì˜ ì—­í• 
{agent-team-spec.mdì—ì„œ í•´ë‹¹ ì—­í•  ì„¹ì…˜}

## ì¦ê±° ìë£Œ (ì‚¬ì „ í•„í„°ë§ë¨)
Step 0.7ì—ì„œ ì´ ì—­í• ì— ê´€ë ¨ëœ ì¦ê±°ë§Œ ì„ ë³„í•˜ì—¬ ì „ë‹¬í•©ë‹ˆë‹¤.
ì „ì²´ ì¸ë±ìŠ¤ê°€ ì•„ë‹Œ, ì—­í• ë³„ë¡œ ë¶„ë°°ëœ ì²­í¬ í…ìŠ¤íŠ¸ë¥¼ í¬í•¨í•©ë‹ˆë‹¤:
{ì—­í• ë³„ ì‚¬ì „ ì¡°í•©ëœ ì¦ê±° í…ìŠ¤íŠ¸}

## ì¶œë ¥ ê·œì¹™
1. agent-team-spec.mdì˜ JSON ê³„ì•½ì„ ì¤€ìˆ˜í•˜ì„¸ìš”.
2. ëª¨ë“  ì£¼ì¥(claim)ì—ëŠ” ë°˜ë“œì‹œ citationì„ í¬í•¨í•˜ì„¸ìš” (citation-spec.md ì°¸ì¡°).
3. JSON íŒŒì¼ê³¼ Markdown íŒŒì¼ì„ ëª¨ë‘ ìƒì„±í•˜ì„¸ìš”.
4. JSON í‚¤ëŠ” ì•ŒíŒŒë²³ìˆœìœ¼ë¡œ ì •ë ¬í•˜ì„¸ìš”.

## ì¶œë ¥ ê²½ë¡œ
- JSON: .claude/artifacts/agents/{role}.json
- Markdown: .claude/artifacts/agents/{role}.md

## íŒ€ í†µì‹  (í•„ìˆ˜)
ë‹¹ì‹ ì€ "research-v{N}" íŒ€ì˜ "{role}-agent" íŒ€ì›ì…ë‹ˆë‹¤.
`.claude/spec/agent-team-spec.md`ì˜ "íŒ€ì› ê³µí†µ ì ˆì°¨"ë¥¼ ë°˜ë“œì‹œ ë”°ë¥´ì„¸ìš”.
íƒœìŠ¤í¬ëª…: "{role_name} ë¶„ì„ ìˆ˜í–‰"
```

### ë™ì  ì—­í•  ì—ì´ì „íŠ¸ í”„ë¡¬í”„íŠ¸

ê³ ì • ì—­í• ê³¼ ë™ì¼í•œ êµ¬ì¡°ì´ë˜, ì—­í•  ì •ì˜ë¥¼ `project.json`ì˜ `dynamic_roles`ì—ì„œ ë¡œë“œí•©ë‹ˆë‹¤:

```
ë‹¹ì‹ ì€ {dynamic_roles[].name} ì „ë¬¸ê°€ì…ë‹ˆë‹¤.

## í”„ë¡œì íŠ¸ ì»¨í…ìŠ¤íŠ¸
{project.json ë‚´ìš©}

## ë‹¹ì‹ ì˜ ì—­í• 
- ì—­í• ëª…: {dynamic_roles[].name}
- ì±…ì„ ë²”ìœ„: {dynamic_roles[].responsibility}
- í•„ìˆ˜ ì¶œë ¥ ì„¹ì…˜: {dynamic_roles[].output_sections}

## ì¦ê±° ìë£Œ (ì‚¬ì „ í•„í„°ë§ë¨)
Step 0.7ì—ì„œ ì´ ì—­í• ì˜ keywordsì— ë§¤ì¹­ëœ ì¦ê±°ë§Œ ì„ ë³„í•˜ì—¬ ì „ë‹¬í•©ë‹ˆë‹¤:
{ì—­í• ë³„ ì‚¬ì „ ì¡°í•©ëœ ì¦ê±° í…ìŠ¤íŠ¸}

## ì¶œë ¥ ê·œì¹™
1. agent-team-spec.mdì˜ JSON ê³„ì•½(ê³µí†µ Envelope)ì„ ì¤€ìˆ˜í•˜ì„¸ìš”.
2. ëª¨ë“  ì£¼ì¥(claim)ì—ëŠ” ë°˜ë“œì‹œ citationì„ í¬í•¨í•˜ì„¸ìš” (citation-spec.md ì°¸ì¡°).
3. JSON íŒŒì¼ê³¼ Markdown íŒŒì¼ì„ ëª¨ë‘ ìƒì„±í•˜ì„¸ìš”.
4. JSON í‚¤ëŠ” ì•ŒíŒŒë²³ìˆœìœ¼ë¡œ ì •ë ¬í•˜ì„¸ìš”.

## ì¶œë ¥ ê²½ë¡œ
- JSON: .claude/artifacts/agents/{role_id}.json
- Markdown: .claude/artifacts/agents/{role_id}.md

## íŒ€ í†µì‹  (í•„ìˆ˜)
ë‹¹ì‹ ì€ "research-v{N}" íŒ€ì˜ "{role}-agent" íŒ€ì›ì…ë‹ˆë‹¤.
`.claude/spec/agent-team-spec.md`ì˜ "íŒ€ì› ê³µí†µ ì ˆì°¨"ë¥¼ ë°˜ë“œì‹œ ë”°ë¥´ì„¸ìš”.
íƒœìŠ¤í¬ëª…: "{role_name} ë¶„ì„ ìˆ˜í–‰"
```

---

## ì™„ë£Œ í›„: Drive ì—…ë¡œë“œ í™•ì¸

ë¬¸ì„œ ìƒì„±ì´ ì™„ë£Œë˜ë©´:

### `/auto-generate`ì—ì„œ í˜¸ì¶œëœ ê²½ìš°
- ì—…ë¡œë“œ í”„ë¡¬í”„íŠ¸ë¥¼ **ìŠ¤í‚µ**í•©ë‹ˆë‹¤.
- ì»¨í…ìŠ¤íŠ¸: í”„ë¡¬í”„íŠ¸ì— `called_from: auto-generate` í‘œì‹œê°€ ìˆìŒì„ í™•ì¸.
- ì™„ë£Œ ìƒíƒœë§Œ ë°˜í™˜ â†’ auto-generateê°€ ë‹¤ìŒ ë‹¨ê³„(ì—…ë¡œë“œ ì—¬ë¶€) íŒë‹¨.

### ë‹¨ë… ì‹¤í–‰ëœ ê²½ìš° (`/run-research` ì§ì ‘ í˜¸ì¶œ)
ì‚¬ìš©ìì—ê²Œ ë¬¼ì–´ë´…ë‹ˆë‹¤:

> "{document_type_name} v{N}ì´ ìƒì„±ë˜ì—ˆìŠµë‹ˆë‹¤. Google Driveì— ì—…ë¡œë“œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?"

- ìˆ˜ë½ ì‹œ: `/upload-drive`ë¥¼ ì‹¤í–‰í•©ë‹ˆë‹¤.
- ê±°ë¶€ ì‹œ: "ë‚˜ì¤‘ì— `/upload-drive`ë¡œ ì—…ë¡œë“œí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤."ë¥¼ ì•ˆë‚´í•©ë‹ˆë‹¤.

---

## ì¶œë ¥

| íŒŒì¼ | ì„¤ëª… |
|------|------|
| `.claude/artifacts/agents/{role}.json` | ê° ì—­í• ì˜ êµ¬ì¡°í™”ëœ ì¶œë ¥ |
| `.claude/artifacts/agents/{role}.md` | ê° ì—­í• ì˜ ì„œìˆ í˜• ìš”ì•½ |
| `.claude/artifacts/{output_dir}/v{N}/{output_file}` | ìµœì¢… í†µí•© ë¬¸ì„œ (ë²„ì „ë³„) |
| `.claude/artifacts/{output_dir}/v{N}/citations.json` | ì „ì²´ ì¸ìš© ë³´ê³ ì„œ |
| `.claude/artifacts/{output_dir}/v{N}/conflicts.json` | ì—­í•  ê°„ ì¶©ëŒ ë³´ê³ ì„œ |
| `.claude/artifacts/{output_dir}/v{N}/metadata.json` | ë²„ì „ ë©”íƒ€ë°ì´í„° |

---

## ì™„ë£Œ í›„

auto-generateì—ì„œ í˜¸ì¶œëœ ê²½ìš° ìë™ìœ¼ë¡œ ë‹¤ìŒ ë‹¨ê³„(ê²€ì¦)ë¡œ ì§„í–‰í•©ë‹ˆë‹¤.
